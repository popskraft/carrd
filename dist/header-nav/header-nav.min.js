/* Header Nav v0.1.9 (2026-02-10) */(function(){'use strict';const DEFAULTS={headerId:'site-header',navId:'site-header-nav',navSelector:'.links-component',ctaId:'site-header-cta',mobileStickyAnchorId:'site-header-topnav',mobileStickyOffset:0,mobileStickyTop:null,breakpoint:736,closeOnLinkClick:true,sticky:true,hideOnScrollDown:false,stickyTop:0};const externalOptions=(typeof window!=='undefined'&&window.CarrdPluginOptions&&window.CarrdPluginOptions.headerNav)||{};const normalizeConfig=(options)=>{const hasLegacyStickyFlag=typeof options.enableStickyHider==='boolean';const stickyFromLegacy=hasLegacyStickyFlag?options.enableStickyHider:undefined;let sticky=typeof options.sticky==='boolean'?options.sticky:(stickyFromLegacy!==undefined?stickyFromLegacy:DEFAULTS.sticky);if(options.disableStickyEffect===true)sticky=false;return{...DEFAULTS,...options,sticky};};const CONFIG=normalizeConfig(externalOptions);const STICKY_SCROLL_DELTA=4;const LEGACY_STYLE_DEFAULTS={animationDuration:50,navMaxHeight:'80vh'};const CLASSES={root:'theme-header-nav',toggle:'theme-header-nav-toggle',bar:'theme-header-nav-bar',menu:'theme-header-nav-menu',cta:'theme-header-nav-cta',section:'theme-header-nav-section',sectionBrand:'theme-header-nav-section-brand',sectionNav:'theme-header-nav-section-nav',sectionCta:'theme-header-nav-section-cta',sectionExtra:'theme-header-nav-section-extra',open:'is-nav-open',mobile:'is-mobile',sticky:'is-sticky-hider',stuck:'is-stuck',hidden:'is-hidden',spacer:'theme-header-nav-spacer'};const CSS_VARS={duration:'--theme-header-nav-duration',navMaxHeight:'--theme-header-nav-max-height',openHeight:'--theme-header-nav-open-height',stickyTop:'--theme-header-nav-sticky-top',fixedLeft:'--theme-header-nav-fixed-left',fixedWidth:'--theme-header-nav-fixed-width'};function createToggleButton(){const button=document.createElement('button');button.type='button';button.className=CLASSES.toggle;button.setAttribute('aria-label','Toggle navigation');button.setAttribute('aria-expanded','false');for(let i=0;i<3;i+=1){const bar=document.createElement('span');bar.className=CLASSES.bar;button.appendChild(bar);}return button;}function findNavElement(header){const isValidNav=(element)=>Boolean(element&&element!==header&&header.contains(element));const configuredNav=CONFIG.navId?document.getElementById(CONFIG.navId):null;if(isValidNav(configuredNav))return configuredNav;const configuredSelector=typeof CONFIG.navSelector==='string'?CONFIG.navSelector.trim():'';if(configuredSelector){const navBySelector=header.querySelector(configuredSelector);if(isValidNav(navBySelector))return navBySelector;}const fallbackNav=header.querySelector('.links-component');if(isValidNav(fallbackNav))return fallbackNav;return null;}function findCtaElement(header){const ctaId=typeof CONFIG.ctaId==='string'?CONFIG.ctaId.trim():'';if(ctaId){const ctaById=document.getElementById(ctaId);if(ctaById&&header.contains(ctaById))return ctaById;}return header.querySelector('.buttons-component');}function ensureElementId(element,preferredBaseId,forbiddenId){const hasValidCurrentId=element.id&&element.id!==forbiddenId;if(hasValidCurrentId)return element.id;const baseId=preferredBaseId||'header-nav-element';let candidateId=baseId;let suffix=1;let existing=document.getElementById(candidateId);while(existing&&existing!==element){candidateId=baseId+'-'+suffix;suffix+=1;existing=document.getElementById(candidateId);}element.id=candidateId;return candidateId;}function getDirectSectionElement(target,sectionContainer){let current=target;while(current&&current.parentElement&&current.parentElement!==sectionContainer){current=current.parentElement;}if(current&&current.parentElement===sectionContainer){return current;}return null;}function init(){const header=document.getElementById(CONFIG.headerId);const nav=header?findNavElement(header):null;if(!header||!nav)return;if(header.dataset.headerNavInitialized==='true')return;header.dataset.headerNavInitialized='true';header.classList.remove('theme-scroll-header','is-scroll-visible');header.classList.add(CLASSES.root);const animationDuration=typeof externalOptions.animationDuration==='number'?externalOptions.animationDuration:LEGACY_STYLE_DEFAULTS.animationDuration;const navMaxHeight=typeof externalOptions.navMaxHeight==='string'?externalOptions.navMaxHeight:LEGACY_STYLE_DEFAULTS.navMaxHeight;header.style.setProperty(CSS_VARS.duration,animationDuration+'ms');header.style.setProperty(CSS_VARS.navMaxHeight,navMaxHeight);const mobileStickyAnchorId=typeof CONFIG.mobileStickyAnchorId==='string'?CONFIG.mobileStickyAnchorId.trim():'';const mobileStickyAnchor=mobileStickyAnchorId?document.getElementById(mobileStickyAnchorId):null;let activeStickyTop=CONFIG.stickyTop;let activeStickyTriggerTop=CONFIG.stickyTop;const initialHeaderHeight=header.style.height;const initialHeaderMaxHeight=header.style.maxHeight;let previousScrollY=window.scrollY||window.pageYOffset||0;let stickyAnchorY=0;let wasStuck=false;const toggle=createToggleButton();const navId=ensureElementId(nav,CONFIG.headerId+'-nav',CONFIG.headerId);toggle.setAttribute('aria-controls',navId);header.appendChild(toggle);nav.classList.add(CLASSES.menu);const sectionContainer=header.querySelector('.wrapper > .inner');if(sectionContainer){Array.from(sectionContainer.children).forEach((section,index)=>{section.classList.add(CLASSES.section);if(index===0){section.classList.add(CLASSES.sectionBrand);}else{section.classList.add(CLASSES.sectionExtra);}});const navSection=getDirectSectionElement(nav,sectionContainer);if(navSection){navSection.classList.add(CLASSES.sectionNav);navSection.classList.remove(CLASSES.sectionExtra);navSection.classList.remove(CLASSES.sectionBrand);}const cta=findCtaElement(header);if(cta){cta.classList.add(CLASSES.cta);const ctaSection=getDirectSectionElement(cta,sectionContainer);if(ctaSection){ctaSection.classList.add(CLASSES.sectionCta);ctaSection.classList.remove(CLASSES.sectionExtra);ctaSection.classList.remove(CLASSES.sectionBrand);}}}nav.setAttribute('aria-hidden','true');const spacer=document.createElement('div');spacer.className=CLASSES.spacer;if(!header.parentNode)return;header.parentNode.insertBefore(spacer,header);if(CONFIG.sticky){header.classList.add(CLASSES.sticky);}const clearLegacyScrollHeaderState=()=>{header.classList.remove('theme-scroll-header','is-scroll-visible');};const getHeaderFlowHeight=()=>{const headerStyles=window.getComputedStyle(header);const marginTop=parseFloat(headerStyles.marginTop)||0;const marginBottom=parseFloat(headerStyles.marginBottom)||0;return header.getBoundingClientRect().height+marginTop+marginBottom;};const getMobileStickyTriggerTop=()=>{const extraOffset=typeof CONFIG.mobileStickyOffset==='number'?CONFIG.mobileStickyOffset:0;if(!mobileStickyAnchor)return CONFIG.stickyTop+extraOffset;const anchorRect=mobileStickyAnchor.getBoundingClientRect();return CONFIG.stickyTop+extraOffset+Math.max(0,anchorRect.height);};const getMobileStickyTop=()=>{if(typeof CONFIG.mobileStickyTop==='number'&&Number.isFinite(CONFIG.mobileStickyTop)){return CONFIG.mobileStickyTop;}return getMobileStickyTriggerTop();};const applyStickyTop=()=>{header.style.setProperty(CSS_VARS.stickyTop,activeStickyTop+'px');};const syncMenuHeight=()=>{if(!header.classList.contains(CLASSES.mobile)){header.style.removeProperty(CSS_VARS.openHeight);return;}const menuHeight=nav.scrollHeight;if(menuHeight>0){header.style.setProperty(CSS_VARS.openHeight,menuHeight+'px');}};const updateStickyAnchor=()=>{const currentScrollY=window.scrollY||window.pageYOffset||0;const anchorRect=header.classList.contains(CLASSES.stuck)?spacer.getBoundingClientRect():header.getBoundingClientRect();const anchorTop=anchorRect.top+currentScrollY;const mobileTriggerOffset=header.classList.contains(CLASSES.mobile)?anchorRect.height:0;stickyAnchorY=anchorTop+mobileTriggerOffset;};const syncFixedLayout=()=>{const spacerRect=spacer.getBoundingClientRect();header.style.setProperty(CSS_VARS.fixedLeft,spacerRect.left+'px');header.style.setProperty(CSS_VARS.fixedWidth,spacerRect.width+'px');spacer.style.height=getHeaderFlowHeight()+'px';};const clearFixedLayout=()=>{header.style.removeProperty(CSS_VARS.fixedLeft);header.style.removeProperty(CSS_VARS.fixedWidth);spacer.style.height='0px';};const setOpenState=(isOpen)=>{if(isOpen){syncMenuHeight();}header.classList.toggle(CLASSES.open,isOpen);toggle.setAttribute('aria-expanded',isOpen?'true':'false');nav.setAttribute('aria-hidden',isOpen?'false':'true');if(isOpen){header.style.height='auto';header.style.maxHeight='none';}else{header.style.height=initialHeaderHeight;header.style.maxHeight=initialHeaderMaxHeight;}if(isOpen){header.classList.remove(CLASSES.hidden);}if(header.classList.contains(CLASSES.stuck)){syncFixedLayout();}};const updateStickyHiderState=()=>{if(!CONFIG.sticky)return;clearLegacyScrollHeaderState();const currentScrollY=window.scrollY||window.pageYOffset||0;const isStuck=currentScrollY+activeStickyTriggerTop>=stickyAnchorY;if(isStuck&&!wasStuck){syncFixedLayout();}header.classList.toggle(CLASSES.stuck,isStuck);if(!isStuck&&wasStuck){clearFixedLayout();updateStickyAnchor();}if(!isStuck){header.classList.remove(CLASSES.hidden);previousScrollY=currentScrollY;wasStuck=false;return;}if(header.classList.contains(CLASSES.open)){header.classList.remove(CLASSES.hidden);previousScrollY=currentScrollY;wasStuck=true;return;}if(CONFIG.hideOnScrollDown){const isScrollingDown=currentScrollY>previousScrollY+STICKY_SCROLL_DELTA;const isScrollingUp=currentScrollY<previousScrollY-STICKY_SCROLL_DELTA;if(isScrollingDown&&currentScrollY>stickyAnchorY){header.classList.add(CLASSES.hidden);}else if(isScrollingUp||currentScrollY<=activeStickyTriggerTop){header.classList.remove(CLASSES.hidden);}}else{header.classList.remove(CLASSES.hidden);}previousScrollY=currentScrollY;wasStuck=true;};const updateViewportState=()=>{clearLegacyScrollHeaderState();const isMobile=window.innerWidth<=CONFIG.breakpoint;header.classList.toggle(CLASSES.mobile,isMobile);activeStickyTriggerTop=isMobile?getMobileStickyTriggerTop():CONFIG.stickyTop;activeStickyTop=isMobile?getMobileStickyTop():CONFIG.stickyTop;applyStickyTop();syncMenuHeight();if(!isMobile){setOpenState(false);}if(!CONFIG.sticky){header.classList.remove(CLASSES.stuck,CLASSES.hidden);clearFixedLayout();}if(header.classList.contains(CLASSES.stuck)){syncFixedLayout();}else{updateStickyAnchor();}};toggle.addEventListener('click',()=>{if(!header.classList.contains(CLASSES.mobile))return;const isOpen=header.classList.contains(CLASSES.open);setOpenState(!isOpen);});if(CONFIG.closeOnLinkClick){nav.addEventListener('click',(event)=>{const link=event.target.closest('a');if(!link)return;if(!header.classList.contains(CLASSES.mobile))return;setOpenState(false);});}window.addEventListener('resize',updateViewportState);window.addEventListener('scroll',updateStickyHiderState,{passive:true});window.addEventListener('load',syncMenuHeight);if(typeof ResizeObserver!=='undefined'){const resizeObserver=new ResizeObserver(()=>{if(header.classList.contains(CLASSES.stuck)){syncFixedLayout();}else{updateStickyAnchor();}updateViewportState();});resizeObserver.observe(header);if(mobileStickyAnchor){resizeObserver.observe(mobileStickyAnchor);}}applyStickyTop();updateViewportState();updateStickyAnchor();updateStickyHiderState();}if(document.readyState==='loading'){document.addEventListener('DOMContentLoaded',init);}else{init();}})();